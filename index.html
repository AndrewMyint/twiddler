<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <script src="node_modules/moment/moment.js"></script>
    <link rel = "stylesheet" type = "text/css" href = "style.css">
  </head>
  <body>
    <div class = 'header'>
      <h1 id = 'head'>Twiddler</h1>
    </div>
    
    <div class = "head-container">
 
        <div class = "tweetBox"> 
          
          <input id = "currentUser" class = "textBox" type="textBox" name="loginName" placeholder="username">
          <button class = "btn" name = "submit" type = "submit">Tweet</button>
          <textarea id = "textArea"  cols = "81" rows= "5"></textarea>

        </div>  
 
        <div class = "container">    
        </div>
      
    </div>



      <script>
        $(document).ready(function(){
         
          var $container = $('.container');
          $container.html('');

          var index = streams.home.length - 1;

          while(index >= 0){
            var tweet = streams.home[index];
         
            var $username = $('<span class = "username"> </span>');
            var $userTag = $('<span class = "userTag"> </span>')
            var $itemHeaderGroup = $('<div class = itemHeaderGroup></div>');
            var $time = $('<span id = "time"> </span>');

            var $avater = $('<img class = "avater" src = "https://abs.twimg.com/sticky/default_profile_images/default_profile_bigger.png">')
            var $tweet = $('<div class = "tweet"><p> </p></div>');
            var $content = $('<div class = "content"> </div>');
            
            $username.text(tweet.user);
            $userTag.text('@' + tweet.user);
            $tweet.text(tweet.message);
           // $time.text(time);

            $username.appendTo($itemHeaderGroup);
            $userTag.appendTo($itemHeaderGroup);
            //$time.appendTo($content); 

            $avater.appendTo($content); 
            $itemHeaderGroup.appendTo($content);

            $tweet.appendTo($content);

            $content.appendTo($container);
           

            index -= 1;
          }
          
          $("button").click(function (event) {
            var timeStamp = new Date();
            var time = moment().format("h:mm a - D MMM YYYY");

            var newTweet = $("#textArea").val();
            var currentUser = $("#currentUser").val();
            var $username = $('<span class = "username"> </span>');
            var $userTag = $('<span class = "userTag"> </span>');
            var $timesAgo = $('<span id = "timesAgo" </span>');
            var $time = $('<span id = "time"> </span>');
            var $itemHeaderGroup = $('<div class = itemHeaderGroup></div>');


            var $avater = $('<img class = "avater" src = "https://abs.twimg.com/sticky/default_profile_images/default_profile_bigger.png">')
            var $tweet = $('<div class = "tweet"><p> </p></div>')
            var $content = $('<div class = "content"> </div>');

            $username.text(currentUser);
            $userTag.text('@' + currentUser);
            $timesAgo.text("- " + moment(timeStamp).fromNow());
            $tweet.text(newTweet);
            $time.text(time);
            

            
            $username.appendTo($itemHeaderGroup)
            $userTag.appendTo($itemHeaderGroup);
            //$timesAgo.appendTo($itemHeaderGroup);
            //   function updateContent(){
            //    $timesAgo.text(moment(new Date()).fromNow());
            //    
            
            // }setInterval(updateContent(), 2000);
            $timesAgo.appendTo($itemHeaderGroup);
            $avater.appendTo($content);
            $itemHeaderGroup.appendTo($content); 
            $tweet.appendTo($content); 
            $time.appendTo($content); 

            $content.prependTo($container);
           // var count = 1;

            setInterval(function() {
             // count++;
              $timesAgo.html("- " + moment(timeStamp).fromNow());
            }, 2000);
            



          })
          

          function generateDateFormat(timeStamp) {
  
            var year = timeStamp.getFullYear();
            var shortMonthName = new Intl.DateTimeFormat("en-US", { month: "short" }).format;
            var month = shortMonthName(timeStamp);
            var day = timeStamp.getDate();
            var time = timeStamp.toLocaleString('en-US', { hour: 'numeric', minute: 'numeric', hour12: true })

            var arr = [];
            arr.push(time);
            arr.push(day);
            arr.push(month);
            arr.push(year);

            return arr.join(' ');
          }
          function updateTime(){
            return setInterval(moment().fromNow(), 2000);
          }

         });
       </script>

  </body>
</html>















